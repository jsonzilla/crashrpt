<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Sending Error Reports</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="style.css" rel="stylesheet" type="text/css">
<link rel="icon" href="../favicon.ico" type="image/x-icon" />
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<link href="$relpath/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="$relpath/search.js"></script>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<div style="padding:10px">
<table border="0" bgcolor="#FFFFFF" cellspacing="5" width="100%">
 <tr>
  <td width="24px" rowspan="2"><img src="../logo.png" alt="Logo" /></td>
  <td><font family="Arial" size="+2">crashrpt</font></td>
  <td rowspan="2" align="right"></td>
 </tr>
 <tr>
  <td colspan="2"><span style="font-size:0.9em"><i>A crash reporting system for Windows applications</i></a></td>
 </tr>
</table>
</div>
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="index.html">CrashRpt Documentation</a></li><li class="navelem"><a class="el" href="using_crashrpt.html">Using CrashRpt in Your Project</a></li><li class="navelem"><a class="el" href="using_crashrpt_api.html">Using CrashRpt API</a></li>  </ul>
</div>
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Sending Error Reports </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This page contains instructions on how to configure CrashRpt to send (or not to send) error reports to your server through HTTP (or HTTPS) connection or through E-mail messages.</p>
<h1><a class="anchor" id="enable_send"></a>
Enabling or Disabling Crash Report Delivery</h1>
<p>When crash occurs, CrashRpt runs the <em>CrashSender.exe</em> process and passes information about the crash to that process through shared memory. <em>CrashSender.exe</em> then collects additional crash information (desktop screen shot, crash minidump, application-defined files). The parent process is then terminated and error report delivery is continued in background in <em>CrashSender.exe</em> process.</p>
<p>The <em>CrashSender.exe</em> is by default assumed to be located in the same folder as <em>CrashRpt.dll</em>. Optionally, you can specify a different path using the CR_INSTALL_INFO::pszCrashSenderPath structure member.</p>
<p>If your want to just collect and save crash report files to disc, but not to send the report, you can specify <a class="el" href="_crash_rpt_8h.html#a07d53781e0ea5636b4d0218619460050">CR_INST_DONT_SEND_REPORT</a> flag for CR_INSTALL_INFO::dwFlags member. This forces <em>CrashSender.exe</em> to exit after crash report data collection is finished.</p>
<p>By default, CrashRpt stores error report files in uncompressed state. If you want to additionally compress error reports and store them as ZIP archives, specify the <a class="el" href="_crash_rpt_8h.html#a3955e27367d579d17679f6b627d858f1">CR_INST_STORE_ZIP_ARCHIVES</a> flag for CR_INSTALL_INFO::dwFlags member.</p>
<h1><a class="anchor" id="folder"></a>
Where does CrashRpt Store Error Report Files?</h1>
<p>By default, <em>CrashSender.exe</em> saves error report files to <em>%LOCAL_APP_DATA%\CrashRpt\UnsentErrorReports\%AppName%_%AppVersion%</em> folder. Optionally, you can specify another location where to store files using CR_INSTALL_INFO::pszErrorReportSaveDir structure member.</p>
<h1><a class="anchor" id="progressdlg"></a>
Sending Error Report Dialog</h1>
<p>The <b>Sending Error Report</b> dialog (presented in the figure below) shows the progress of sending the error report. There are maximum three attempts to send the report: using HTTP (or HTTPS), using SMTP, and using Simple MAPI.</p>
<div class="image">
<img src="progressdlg.png" alt=""/>
<div class="caption">
Sending Error Report Dialog</div></div>
<p>The client application can specify the priority (order) of delivery methods through CR_INSTALL_INFO::uPriorities structure member. By default HTTP (or HTTPS) connection is tried the first, SMTP connection is tried the second, and Simple MAPI is tried the last.</p>
<p>Certain delivery method can be disabled by specifying special constant <a class="el" href="_crash_rpt_8h.html#a8b1fa457e0f62bc3fae070dd403d32a0">CR_NEGATIVE_PRIORITY</a> as method's priority.</p>
<p>In the Sending Error Report dialog, there is a status log area below the progress bar control. It contains the details of report delivery process. The log may be useful when troubleshooting error report delivery issues.</p>
<p>A user can copy some selected lines or the whole log to the clipboard. To do this, he should select several lines of the log, right-click the selection and choose an item from the context menu.</p>
<dl class="section note"><dt>Note</dt><dd>The Sending Error Report dialog becomes hidden in three seconds after start. Then it is displayed as icon in system tray. Double-click the icon to restore the dialog. The dialog is restored automatically when user interaction is required.</dd></dl>
<h1><a class="anchor" id="queued_reports"></a>
Queued Error Report Delivery</h1>
<p>By default, when user presses the "Close the program" button on Error Report dialog (see <a class="el" href="error_report.html">About an Error Report</a>) or when error report delivery fails, CrashRpt deletes error report files. Hovewer, somteimes it may be useful to retry error report delivery later. CrashRpt can save (queue) error report data locally for later delivery. This is acomplished through specifying <a class="el" href="_crash_rpt_8h.html#a1d2fdb48ae4bf477109baf07b29dd26a">CR_INST_SEND_QUEUED_REPORTS</a> flag for CR_INSTALL_INFO::dwFlags member.</p>
<p>On application start up, CrashRpt checks if it is time to remind user about recent error reports ready for delivery, shows notification balloon and offers user to deliver them (see the figure below). CrashRpt shows notification balloon if at least one week elapsed since the last notification.</p>
<div class="image">
<img src="balloon.png" alt=""/>
<div class="caption">
Notification Balloon</div></div>
<p>When user clicks the balloon, the <em>Sending Recent Error Reports</em> dialog appears (shown in the figure below).</p>
<div class="image">
<img src="send_queued_reports.png" alt=""/>
<div class="caption">
Sending Recent Error Reports</div></div>
<p>If user wants to send some queued error reports immediately, he/she presses the "Send now" button. If user wants to postpone the delivery, he/she presses the "Other actions..." button and clicks the "Remind me later" from the context menu, or just closes the window. If user doesn't want to send error reports later, he/she clicks the "Never remind" context menu item.</p>
<h1><a class="anchor" id="httpsend"></a>
Sending Crash Report Using HTTP Connection</h1>
<p>Many software products have web sites on the Internet. Those web servers typically have some scripting engine enabled, for example, PHP and so on. CrashRpt can establish HTTP (or HTTPS) connection to a server-side script and send the error report as a script parameter. To specify the script URL address, use the CR_INSTALL_INFO::pszUrl structure member.</p>
<p>CrashRpt supports HTTP file uploads as described in <a href="http://www.ietf.org/rfc/rfc1867.txt">RFC-1867.</a> This mechanism allows to upload large files by using binary content transfer encoding. The "multipart/form-data" encoding type is utilized for this purpose.</p>
<p>The equivalent HTML form for file uploads is presented below (some form fields may be omitted, see the next section for the complete list of fields that may appear):</p>
<div class="fragment"><div class="line">&lt;html&gt;</div>
<div class="line">&lt;form action=<span class="stringliteral">&quot;http://someserver.net/crashrpt.php&quot;</span> method=<span class="stringliteral">&quot;POST&quot;</span> </div>
<div class="line">      enctype=<span class="stringliteral">&quot;multipart/form-data&quot;</span>&gt;</div>
<div class="line"> Application name:&lt;input type=<span class="stringliteral">&quot;text&quot;</span> name=<span class="stringliteral">&quot;appname&quot;</span>&gt;</div>
<div class="line"> Application version:&lt;input type=<span class="stringliteral">&quot;text&quot;</span> name=<span class="stringliteral">&quot;appversion&quot;</span>&gt;</div>
<div class="line"> Email from:&lt;input type=<span class="stringliteral">&quot;text&quot;</span> name=<span class="stringliteral">&quot;emailfrom&quot;</span>&gt;</div>
<div class="line"> Email subject:&lt;input type=<span class="stringliteral">&quot;text&quot;</span> name=<span class="stringliteral">&quot;emailsubject&quot;</span>&gt;</div>
<div class="line"> Crash GUID:&lt;input type=<span class="stringliteral">&quot;text&quot;</span> name=<span class="stringliteral">&quot;crashguid&quot;</span>&gt;</div>
<div class="line"> MD5:&lt;input type=<span class="stringliteral">&quot;text&quot;</span> name=<span class="stringliteral">&quot;md5&quot;</span>&gt;</div>
<div class="line"> Attach ZIP file:&lt;input type=<span class="stringliteral">&quot;file&quot;</span> name=<span class="stringliteral">&quot;crashrpt&quot;</span>&gt;</div>
<div class="line"> &lt;input type=<span class="stringliteral">&quot;submit&quot;</span> name=<span class="stringliteral">&quot;Submit&quot;</span>&gt;</div>
<div class="line">&lt;/form&gt;</div>
<div class="line">&lt;/html&gt;</div>
</div><!-- fragment --><h2><a class="anchor" id="script_params"></a>
Script Parameters</h2>
<p>Below is the summary of parameters the server-side script may receive.</p>
<p>The server-side script may receive the following POST parameters. In PHP, these parameters are part of <b>$_POST</b> global array.</p>
<table class="doxtable">
<tr>
<th><b>Parameter Name</b> </th><th><b>Example value</b> </th><th><b>Remarks</b> </th></tr>
<tr>
<td>md5 </td><td>"af89e902b42cd301092bb34530984e59" </td><td>This parameter contains the MD5 hash of error report data. This can be used to check error report integrity. </td></tr>
<tr>
<td>appname </td><td>"MyApp" </td><td>Application name (as passed to <b>CR_INSTALL_INFO::pszAppName</b> structure member). <pre class="fragment"> &lt;b&gt;This parameter is available in error report sent by CrashRpt v.1.2.2 or later.&lt;/b&gt;
</pre> </td></tr>
<tr>
<td>appversion </td><td>"1.0.0" </td><td>Application version (as passed to <b>CR_INSTALL_INFO::pszAppVersion</b> structure member). <pre class="fragment"> &lt;b&gt;This parameter is available in error report sent by CrashRpt v.1.2.2 or later.&lt;/b&gt;
</pre> </td></tr>
<tr>
<td>crashguid </td><td>"37b4d6da-1211-4e62-adc6-174acb53ddf5" </td><td>Crash GUID (globally unique identifier). <pre class="fragment"> &lt;b&gt;This parameter is available in error report sent by CrashRpt v.1.2.2 or later.&lt;/b&gt;
</pre> </td></tr>
<tr>
<td>emailsubject </td><td>"MyApp 1.0.0 Error Report" </td><td>E-mail subject (as passed to <b>CR_INSTALL_INFO::pszEmailSubject</b> structure member). <pre class="fragment"> &lt;b&gt;This parameter is available in error report sent by CrashRpt v.1.2.2 or later.&lt;/b&gt;
</pre> </td></tr>
<tr>
<td>emailfrom </td><td>"user@example.com" </td><td>E-mail of the user who sent this report. <pre class="fragment"> &lt;b&gt;This parameter is available in error report sent by CrashRpt v.1.2.2 or later.&lt;/b&gt;
</pre> </td></tr>
<tr>
<td>description </td><td>"I just started the app and then it crashed. Help!" </td><td><p class="starttd">User-provided problem description. </p><pre class="fragment"> &lt;b&gt;This parameter is available in error report sent by CrashRpt v.1.2.2 or later.&lt;/b&gt;
</pre><p class="endtd"></p>
</td></tr>
</table>
<p>The server side script may receive the following file attachments. In PHP, these parameters are part of <b>$_FILES</b> global array.</p>
<table class="doxtable">
<tr>
<th><b>Attachment Name</b> </th><th><b>Remarks</b> </th></tr>
<tr>
<td>crashrpt </td><td>This file attachment contains the error report file data. <pre class="fragment"> &lt;b&gt;This parameter is available in error report sent by CrashRpt v.1.2.2 or later.&lt;/b&gt;
</pre> </td></tr>
</table>
<h2><a class="anchor" id="script_return"></a>
Return Value</h2>
<p>The script should return status of request completion as server response header. In HTTP/1.0 and since, the first line of the HTTP response is called the status line and includes a numeric status code (such as "404") and a textual reason phrase (such as "Not Found").</p>
<p>If the script succeeds in saving the error report, it should return the "200 Success" as server responce header. If the script encounters an error, it should return a 4xx error code, for example "450 Invalid parameter". Note that some error codes are reserved by HTTP specification. If the script uses custom error codes, they shouldn't intersect with standard predefined HTTP codes.</p>
<dl class="section note"><dt>Note</dt><dd>When creating your own script, be careful with the script's return code. If your script succeeds in saving error report it should return '200 Success'. If crash sending process encounters another error code, it attempts sending the error report using another way. In such situation you may receive the same error report several times through different transport.</dd></dl>
<h2><a class="anchor" id="script_example"></a>
Sample PHP Script</h2>
<p>Below is an example server-side PHP script (reporting/scripts/crashrpt.php) that can receive a crash report and write it to a file.</p>
<div class="fragment"></div><!-- fragment --><h1><a class="anchor" id="smtpsend"></a>
Sending Crash Report Using SMTP Connection</h1>
<p>CrashRpt has a simple built-in SMPT client. It can try to send an error report to recipient using SMTP connection without any user interaction. The error report is sent as an E-mail message with attachments.</p>
<p>Many SMTP servers may block direct access to them from dynamic IPs to avoid spam (for example Google Mail does so). This delivery method may also fail if firewall blocks outgoing connections on port 25. Because of this reason, this delivery method is recommended to use if you install your application to a single machine with installed SMTP server (for example, server applications may fit this requirements).</p>
<p>To specify the address of the SMTP server, use CR_INSTALL_INFO::pszSmtpProxy structure member. This parameter defines the network address (IP or domain) and, optionally, port formatted as "address[:port]" of SMTP server.</p>
<p>To specify the recipient of E-mail messages, you use the CR_INSTALL_INFO::pszEmailTo structure member. You can specify the subject of E-mail message using the CR_INSTALL_INFO::pszEmailSubject structure member.</p>
<p>If CR_INSTALL_INFO::pszSmtpProxy is not provided, CrashRpt tries to determine the SMTP server's address from the recipient E-mail address's MX domain record and relays the email message to that server.</p>
<p>If SMTP server requires authentication, you can specify the login and password through CR_INSTALL_INFO::pszSmtpLogin and CR_INSTALL_INFO::pszSmtpPassword members, respectively.</p>
<p>By default CrashRpt generates an E-mail message's text automatically, but if you want to override the E-mail text, you can use the CR_INSTALL_INFO::pszEmailText structure member.</p>
<h1><a class="anchor" id="smapisend"></a>
Sending Crash Report Using Simple MAPI</h1>
<p>CrashRpt can use the default E-mail client, for example, Mozilla Thunderbird or Microsoft Outlook, to send an error report as email. The error report is sent as an E-mail message with attachments. This may require some user interaction. Because of this reason, this delivery method has the lowest priority by default and is unavailable in silent (non-GUI) mode.</p>
<p>To specify the recipient of E-mail messages, you use the CR_INSTALL_INFO::pszEmailTo structure member. You can specify the subject of E-mail message using the CR_INSTALL_INFO::pszEmailSubject structure member.</p>
<p>By default CrashRpt generates an E-mail message's text automatically, but if you want to override the E-mail text, you can use the CR_INSTALL_INFO::pszEmailText structure member.</p>
<h1><a class="anchor" id="error_report_size_limitations"></a>
Error Report Size Limitations</h1>
<p>CrashRpt provides support of large error reports being sent using HTTP (or HTTPS) connection. You can send error reports having arbitrary size, however check your web-server settings to ensure it won't reject reports larger than some limit. For example, if you use PHP, check the <em>upload_max_filesize</em> configuration parameter (the default in 2 megabytes), <em>post_max_size</em> parameter and possibly others (see PHP documentation for details).</p>
<p>In case you plan to deliver error reports over E-mail (SMTP or Simple MAPI), than error reports should be as small as possible. This is because of limitations of email attachment size. If the error report is larger than the limit (which may be different for different mail servers), it is possible that the error report will be rejected.</p>
<p><em>Further reading:</em> <a class="el" href="misc_api_features.html">Miscellaneous API Features</a>. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<hr size="1"><address style="text-align: right;"><small>
Generated on Sat Aug 6 2022 14:05:13 for CrashRpt by&nbsp;<a href="http://www.doxygen.org/index.html"><img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.8.17</small></address>
</body>
</html>
